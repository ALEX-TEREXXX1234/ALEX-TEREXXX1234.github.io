<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Лабораторная работа №12</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<script language="JavaScript" type="text/JavaScript">
<!--
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_nbGroup(event, grpName) { //v6.0
  var i,img,nbArr,args=MM_nbGroup.arguments;
  if (event == "init" && args.length > 2) {
    if ((img = MM_findObj(args[2])) != null && !img.MM_init) {
      img.MM_init = true; img.MM_up = args[3]; img.MM_dn = img.src;
      if ((nbArr = document[grpName]) == null) nbArr = document[grpName] = new Array();
      nbArr[nbArr.length] = img;
      for (i=4; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
        if (!img.MM_up) img.MM_up = img.src;
        img.src = img.MM_dn = args[i+1];
        nbArr[nbArr.length] = img;
    } }
  } else if (event == "over") {
    document.MM_nbOver = nbArr = new Array();
    for (i=1; i < args.length-1; i+=3) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = (img.MM_dn && args[i+2]) ? args[i+2] : ((args[i+1])? args[i+1] : img.MM_up);
      nbArr[nbArr.length] = img;
    }
  } else if (event == "out" ) {
    for (i=0; i < document.MM_nbOver.length; i++) {
      img = document.MM_nbOver[i]; img.src = (img.MM_dn) ? img.MM_dn : img.MM_up; }
  } else if (event == "down") {
    nbArr = document[grpName];
    if (nbArr)
      for (i=0; i < nbArr.length; i++) { img=nbArr[i]; img.src = img.MM_up; img.MM_dn = 0; }
    document[grpName] = nbArr = new Array();
    for (i=2; i < args.length-1; i+=2) if ((img = MM_findObj(args[i])) != null) {
      if (!img.MM_up) img.MM_up = img.src;
      img.src = img.MM_dn = (args[i+1])? args[i+1] : img.MM_up;
      nbArr[nbArr.length] = img;
  } }
}
//-->
</script>
</head>

<body bgcolor="#FFCC99">
<blockquote> 
  <div align="justify"></div>
  <blockquote>
<table border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td><a href="002.htm" target="_self" onClick="MM_nbGroup('down','group1','Back','',1)" onMouseOver="MM_nbGroup('over','Back','','',1)" onMouseOut="MM_nbGroup('out')"><img src="img/Back.gif" alt="" name="Back" width="73" height="22" border="0" onload=""></a></td>
        <td><a href="main12.htm" target="_self" onClick="MM_nbGroup('down','group1','Menu','',1)" onMouseOver="MM_nbGroup('over','Menu','','',1)" onMouseOut="MM_nbGroup('out')"><img src="img/Menu.gif" alt="" name="Menu" width="73" height="22" border="0" onload=""></a></td>
        <td><a href="004.htm" target="_self" onClick="MM_nbGroup('down','group1','For','',1)" onMouseOver="MM_nbGroup('over','For','','',1)" onMouseOut="MM_nbGroup('out')"><img src="img/For.gif" alt="" name="For" width="73" height="22" border="0" onload=""></a></td>
      </tr>
    </table>
  </blockquote>
</blockquote>
<p align="center"><strong><font size="5"><em>Извлечение «скрытых знаний» экспертов 
  по ценным бумагам методами локальной геометрии</em></font></strong> </p>
<p align="justify">Есть по крайней мере две серьезные причины, дающие основание 
  говорить о проблеме извлечения «скрытых знаний» у экспертов в различных областях. 
  <br>
  Первая связана с ситуациями, когда эксперт хочет, но не может раскрыть закономерности 
  предметной области и сформулировать четкие правила, которыми он пользуется при 
  принятии тех или иных решений. Такая картина наблюдается в предметных областях 
  с преобладанием эмпирики, для которых характерны так называемые «мягкие» знания, 
  допускающие множественные расплывчатые решения и различные варианты рекомендаций. 
  Это, например, медицина, геология, юриспруденция, финансы и т. д. Здесь знания 
  эксперта часто хранятся в не вербализируемой форме. Хороший эксперт в данных 
  областях имеет богатый опыт и развитую интуицию. Он умеет что-то делать, он 
  знает, как это делается, но не способен объяснить, почему делает именно так. 
  <br>
  Вторая причина связана с аспектом мотивации. Эксперт может, но сознательно или 
  подсознательно не хочет формулировать свои знания. Ведь по сути дела знания 
  являются его самым дорогим продуктом и способствуют благосостоянию эксперта. 
  Одни люди делятся опытом добровольно и с удовольствием, но большая часть специалистов 
  неохотно приоткрывает свои профессиональные тайны. <br>
  Рассматриваемый пример относится к обеим перечисленным ситуациям. Когда люди 
  вкладывают свои средства в ценные бумаги того или иного инвестиционного фонда, 
  они всегда рискуют. Акции фондов падают и повышаются под действием целого ряда 
  объективных и субъективных факторов, влияющих на свободный рынок. В этих условиях 
  выбор наиболее выгодных вложений является весьма сложной задачей. Эксперты по 
  принятию решений в сфере операций с ценными бумагами являются высоко почитаемыми 
  специалистами, оценки которых хорошо оплачиваются. Вместе с тем данные эксперты, 
  с одной стороны, часто используют интуитивные оценки и, с другой - не склонны 
  делиться своими секретами по отмеченным выше обстоятельствам. <br>
  В качестве исходного материала для извлечения «скрытых знаний» экспертов по 
  ценным бумагам будем использовать информацию, описанную в главе 6 в разделе 
  «Кластерный анализ: изучение инвестиционных фондов», где производилось исследование 
  инвестиционных фондов методами кластерного анализа. Вы, вероятно, уже сохранили 
  ее в файле Growth. В последней колонке таблицы данных под именем Recommended 
  введена классификационная переменная, отражающая мнения экспертов по операциям 
  с ценными бумагами изучаемых фондов - buy (покупать), sell (продавать) и hold 
  (держать). <br>
  Прежде всего попытаемся решить задачу классификации экспериментальных данных 
  методами дискриминантного анализа STATGRAPHICS Plus for Windows. В качестве 
  переменных будем использовать 4 признака Risk (риск) Ехреnсе (расходы), Тах 
  (налоги) и Five_ Yr (доходы за пятилетний период).<br>
  <img src="img/file_03_01.png" width="388" height="311"><br>
  Рис 17. Окно для ввода данных в дискриминантный анализ<br>
  Выберем Select | Multivariate Methods | Discriminant Analysis. Система отобразит 
  окно диалога для ввода переменных в дискриминантный анализ. Дважды щелкнем левой 
  кнопкой мыши на переменной Recommended для ввода ее в окно классификационного 
  признака. Введем переменные Ехреnсе Five_ Yr, Risk и Тах в поле Data text bох. 
  Введем переменную Func, (название Фонда) в поле Point Lables. Оставим поле Select 
  незаполненным. Окно диалога для ввода переменных изображено на рис. 17. <br>
  Нажмем кнопку ОК. На экран выдается сводка дискриминантного анализа. <br>
  Рассмотрим внимательно полученную сводку от начала до конца, пользуясь полосой 
  прокрутки. Очевидно, что маленькие р-значения для канонических дискриминантных 
  функций говорят о высокой статистической значимости (рис. 18). <br>
  Нажмем кнопку табличных опций (вторая слева в верхнем ряду). Система выдаст 
  соответствующее окно диалога. <br>
  Установим флажки Classification Functions (классифицирующие функции) и Classification 
  Тablе (таблица классификаций, затем нажмем кнопку ОК. Система до6авит соответствующие 
  окна анализа на экран. Дважды щелкнем левой кнопкой мыши на та6лице классификаций 
  для максимизации ее размеров (рис. 19). <br>
  Из та6лицы следует, что дискриминантные функции правильно классифицируют 15 
  из 16 фондов. Это в принципе успешный результат. Вместе с тем допущенная ошибка 
  может иметь серьезные последствия. Эта оши6ка в классе Sell. Вместо того, чтобы 
  продавать ценные бумаги, автоматическая классификация на основе рассчитанных 
  дискриминантных функций дает рекомендацию Buy - покупать. Также следует отметить, 
  что применение дис-криминантных функций в таком деликатном и ответственном деле 
  имеет еще один недостаток. Этот вид анализа данных не имеет функции интерпретации 
  получаемых результатов. Единственное, что нам дается для попытки их осмысления, 
  - весовые коэффициенты переменных. То есть здесь только с очень большой натяжкой 
  можно говорить о получении нового знания. <br>
  <img src="img/file_03_02.png" width="461" height="260"><br>
  Рис. 18. Сводка канонического дискриминантного анализа</p>
<p align="justify"> <img src="img/file_03_03.png" width="485" height="280"><br>
  Рис. 19. Таблица классификаций<br>
  Причина количественной ошибки дискриминантного анализа при классификации данных 
  об инвестиционных фондах хорошо видна из рис. 20. <br>
  На этом рисунке изображены проекции объектов исследования на плоскость первых 
  двух канонических дискриминантных функций. Хотя, судя по рисунку, области различных 
  классов не пересекаются , но два объекта класса Sell (изображены кружками) в 
  нижней левой части явно более близки к центроиду класса Вuу, чем к центроиду 
  своего класса. Класс Sell, похоже, весьма неоднороден. А, как известно, традиционные 
  методы анализа данных в этих условиях особенно проявляют свои слабости.<br>
  <img src="img/file_03_04.png" width="487" height="303"> <br>
  Рис. 20. Проекция объектов на плоскость первых двух канонических дискриминантных 
  функций<br>
  Приступим к анализу тех же самых данных методами локальной геометрии по технологии, 
  описанной в предыдущем разделе. <br>
  Прежде всего, проанализировав одномерные распределения исследуемых переменных, 
  сгенерируем новые бинарные признаки по правилам, описанным в табл. 11.</p>
<p align="justify">Таблица 11. Обозначения и правила кодировки новых бинарных 
  признаков<br>
  <img src="img/file_03_05.png" width="580" height="77"> </p>
<p align="justify">Правила расшифровки значений новых бинарных при знаков приведены 
  ниже (табл.12). <br>
  Для генерации новых признаков в STATGRAPHICS Plus for Windows откроем файл данных 
  Growth и, маркируя новые колонки таблицы данных, щелчком правой кнопки мыши 
  вызовем меню, из которого выберем Modify Column для ввода имен бинарных признаков 
  и Generate Data для ввода правила кодировки. <br>
  Например. построим локальную метрику для объекта №4 класса Hold. Введем переменную 
  class и через меню Generate Data сгенерируем значения 0 в классе Hold и значения 
  1 для всех остальных объектов, включая «шум». Доля шума в нашем случае пусть 
  будет равной доле исходной информации. То есть введем 16 дополнительных «шумящих» 
  объектов.<br>
  Передадим часть та6лицы данных STATGRAPHICS, относящуюся к новым 6инарным признакам, 
  через 6уфер обмена в электронную та6лицу Excel. Произведем там центрирование 
  данных относительно вы6ранного объекта 4 и возвратим центрированные данные обратно 
  в STATGRAPHICS. Теперь все готово для поиска логической закономерности посредством 
  совокупного применения математических методов анализа и средств интерактивной 
  графики. С помощью процедуры множественной регрессии по методу наименьших квадратов, 
  будут рассчитываться параметры новой координатной оси в локальном пространстве 
  (параметры локальной метрики), максимально коррелирующей с зависимой переменной 
  class, а средствами интерактивной графики из анализа будут исключаться наиболее 
  удаленные от нулевой отметки новой оси объекты, так как для анализа интерес 
  представляет только сравнительно небольшая окрестность центрального объекта.</p>
<p align="justify">Таблица 12. Правила расшифровки значений бинарных признаков<br>
  <img src="img/file_03_06.png" width="605" height="362"><br>
  Вызовем из меню Relate процедуру множественной регрессии Multiple Regression 
  и введем в поле Dependent Variable (зависимая переменная) имя class, а в поле 
  Independent Variables (независимые переменные) - сгенерированные бинарные признаки 
  Е1, Е2, R1, R2, RЗ, F1, F2, FЗ, Т1 и Т2 (рис. 21). <br>
  Нажмем ОК. На экран выдается сводка множественного регрессионного анализа. Щелкнем 
  правой кнопкой мыши и в появившемся окне диалога снимем флажок Constant in Model 
  (постоянный член в уравнении множественной регрессии). Исходя из новой сводки, 
  исключим из анализа признак RЗ с отрицательным весом. Нажмем кнопку графических 
  опций и в окне диалога установим флажок Observed versus Predieted - график, 
  где по оси ординат отложены значения независимой переменной, а по оси абсцисс 
  значения, даваемые моделью множественной регрессии. Нажмем кнопку ОК. На экране 
  отобразятся два окна. Первое - с табличными данными, второе - с вы6ранным графиком 
  (рис. 22).<br>
  <img src="img/file_03_07.png" width="381" height="341"><br>
  Рис. 21. Окно диалога для вывода данных<br>
  <img src="img/file_03_08.png" width="581" height="308"><br>
  Рис. 22. Начальные параметры локальной метрики и исходная конфигурация данных 
  в локальном пространстве<br>
  Исключим из анализа все объекты, удаленные от центрального объекта №4 на расстояние 
  больше 1.05. Для этого сначала сохраним в памяти значения, рассчитанные по модели 
  (нажав четвертую в верхнем левом углу кнопку сохранения результатов и поставив 
  флажок Predieted Values). Затем нажмем первую слева в верхнем ряду кнопку вызова 
  окна диалога для ввода данных и введем в поле Seleсt выражение Prediсted&lt;1.05. 
  Нажмем кнопку ОК. <br>
  Проделаем эти операции дважды и удалим из анализа признаки с отрицательными 
  весами R1 и Е2. Результат после двух итераций показан на рис. 23.<br>
  <img src="img/file_03_09.png" width="457" height="254"><br>
  Рис. 23. Параметры локальной метрики и конфигурация данных после двух операций 
  исключения удаленных от 0 объектов и вычеркивания признаков с отрицательными 
  весами<br>
  Как видно, объекты класса Нold сильно сгруппировались около центрального объекта, 
  а объекты альтернативных классов еще более удалились от центрального объекта. 
  <br>
  Еще раз исключим из анализа объекты, удаленные от центрального объекта на расстояние 
  большее 1.05. Имеем следующие результаты (рис. 24).<br>
  <img src="img/file_03_10.png" width="471" height="263"><br>
  Рис. 24. Параметры локальной .метрики и конфигурация данных после З-й операции 
  по исключению удаленных от 0 объектов</p>
<p align="justify">Тенденция к группированию объектов класса Hold еще более усилилась. 
  <br>
  Проделаем последнюю четвертую серию операций, аналогичную предыдущим. Получаем 
  окончательную конфигурацию данных в локальном пространстве и окончательные параметры 
  локальной метрики (рис. 25). <br>
  Все объекты класса Hold попали в начало координат (небольшой разброс объектов 
  на рисунке введен искусственно, чтобы избежать наложения объектов друг на друга). 
  По данным таблицы у четырех признаков Е1, FЗ, R2,Т веса равны 1, у остальных 
  - О. Это и есть, окончательное решение. Такии конфигурации и таким параметрам 
  локальной метрики соответствует следующее логическое правило: Е1 = 1 &amp; FЗ 
  = 0 &amp; R2 = 1 &amp; Т2 = 0. Семантика полученного правила: Держать акции, 
  если: расходная часть инвестиционного фонда превышает 1.1, доходы за 5 лет не 
  выше 16000, риск больше 3 и, наконец, налог не выше 85. <br>
  Аналогичным образом получены все остальные правила принятия решения по операциям 
  с ценными бумагами. Они приводятся в нижеследующей ( табл. 13).<br>
  Таблица 13. Извлеченные правила принятия решения по операциям с ценными бумагами<br>
  <img src="img/file_03_11.png" width="608" height="298"> </p>
<p align="justify"> <img src="img/file_03_12.png" width="473" height="259"><br>
  Рис. 25. Окончательные параметры локальной метрики и конфигурация данных в локальном 
  пространстве</p>
<p align="justify">Всего для принятия решений по операциям с ценными бумагами 
  потребовалось узнать (извлечь) 6 логических правил. Это достаточно большое количество, 
  учитывая сравнительно малый объем исходных данных, что еще раз свидетельствует 
  о действительно не простой структуре рассмотренной сферы финансов. <br>
  Эффективность извлеченных скрытых знаний по операциям с ценными бумагами фондов 
  характеризуется табл. 14. <br>
  Таблица 14. Эффективность извлеченных знаний <br>
  <img src="img/file_03_13.png" width="351" height="132"> </p>
<p align="justify">Здесь уже нет той грубой (пусть даже единственной) ошибки, 
  которую дают методы классического дискриминантного анализа. Кроме того, каждая 
  рекомендация сопровождается четким вербальным обоснованием. А это и есть действительное 
  знание, которое не было явно сформулировано экспертами и которое так необходимо 
  для построения интеллектуальной системы поддержки принятия решений в рассмотренной 
  предметной области.</p>
<div align="justify"></div>
<blockquote>
  <table border="0" cellpadding="0" cellspacing="0">
    <tr> 
      <td><a href="002.htm" target="_self" onClick="MM_nbGroup('down','group1','Back','',1)" onMouseOver="MM_nbGroup('over','Back','','',1)" onMouseOut="MM_nbGroup('out')"><img src="img/Back.gif" alt="" name="Back" width="73" height="22" border="0" onload=""></a></td>
      <td><a href="main12.htm" target="_self" onClick="MM_nbGroup('down','group1','Menu','',1)" onMouseOver="MM_nbGroup('over','Menu','','',1)" onMouseOut="MM_nbGroup('out')"><img src="img/Menu.gif" alt="" name="Menu" width="73" height="22" border="0" onload=""></a></td>
      <td><a href="004.htm" target="_self" onClick="MM_nbGroup('down','group1','For','',1)" onMouseOver="MM_nbGroup('over','For','','',1)" onMouseOut="MM_nbGroup('out')"><img src="img/For.gif" alt="" name="For" width="73" height="22" border="0" onload=""></a></td>
    </tr>
  </table>
</blockquote>
<div align="center"></div>
</body>
</html>
